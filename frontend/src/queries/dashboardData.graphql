#import "./fragments.graphql"

query DashboardData(
  $startDate: String!
  $endDate: String!
  $branch: String
  $productLine: String
  $itemGroups: [String!]
  $target: Float
) {
  dashboardData(
    startDate: $startDate
    endDate: $endDate
    branch: $branch
    productLine: $productLine
    itemGroups: $itemGroups
    target: $target
  ) {
    revenueSummary {
      totalRevenue
      netSales
      grossProfit
      lineItemCount
      returnsValue
      totalTransactions
      averageTransaction
      uniqueProducts
      uniqueBranches
      uniqueEmployees
      netUnitsSold
    }
    monthlySalesGrowth {
      date
      totalSales
      grossProfit
    }
    targetAttainment {
      attainmentPercentage
      totalSales
      target
    }
    productPerformance {
      product
      sales
    }
    branchProductHeatmap {
      branch
      product
      sales
    }
    topCustomers {
      cardName
      salesAmount
      grossProfit
    }
    marginTrends {
      date
      marginPct
    }
    returnsAnalysis {
      reason
      count
    }
    profitabilityByDimension {
      branch
      grossProfit
      grossMargin
    }
    branchList {
      branch
    }
    productAnalytics {
      itemName
      productLine
      itemGroup
      totalSales
      grossProfit
      margin
      totalQty
      transactionCount
      uniqueBranches
      averagePrice
    }
    dataAvailabilityStatus {
      status
      isMockData
      isFallback
      druidConnected
      message
    }
  }

  # System health and data range info
  systemHealth {
    status
  }
  druidHealth {
    druidStatus
    isAvailable
  }
  druidDatasources {
    datasources
    count
  }
  dataRange {
    earliestDate
    latestDate
    totalRecords
  }

  # Additional data for different pages
  salesPerformance {
    salesPerson
    totalSales
    grossProfit
    transactionCount
    averageSale
    uniqueBranches
    uniqueProducts
    avgMargin
  }

  salespersonProductMix {
    salesperson
    productLine
    avgProfitMargin
  }

  branchPerformance {
    branch
    totalSales
    transactionCount
    averageSale
    uniqueCustomers
    uniqueProducts
  }

  branchGrowth {
    branch
    monthYear
    monthlySales
    growthPct
  }
}
